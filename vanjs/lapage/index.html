<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <title></title>
    <meta content="" name="description">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/vanjs-org/van/public/van-1.2.6.nomodule.min.js"
            type="text/javascript"></script>
    <script type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/vanjs-ext@0.1.3/dist/van-x.nomodule.min.js"></script>
    <meta content="#fafafa" name="theme-color">
</head>

<body>

<div class="grid">
    <div id="formColumn"></div>
    <div id="jsonColumn"></div>
</div>
<script>
    const {button, div, ul, li, pre, form, input, p, label} = van.tags
    const data = van.state("value")


    let dataList = vanX.reactive([{a: 5, b: 3}, {a: 3, b: 4}])
    let jsValHolder =vanX.reactive({})
    jsValHolder.jsonValue= vanX.calc(() => JSON.stringify(dataList, null, 2))

    const result = () => {
        //let s= van.derive(()=>)
        return pre(p(() => jsValHolder.jsonValue))
    }
    const inputField = (displayName, v) => {
        console.log(v)
        return label({for: displayName},
            displayName,
            input({
                type: "text",
                id: displayName,
                name: displayName,
                placeholder: displayName,
                value: v,
                oninput: e => v.val = e.target.value
            }),
        )

        //  return input({value: v, oninput: e => v.val = e.target.value})
    }
    const formFiled = (elem,deleter) => {
        console.log(elem)
        console.log(vanX)
        return div({}, [
            elem,
            inputField("a", vanX.stateFields(elem.val).a),
            inputField("b", vanX.stateFields(elem.val).b),

            ]
        )
    }

    let compo = vanX.list(ul, dataList, (v,deleter) => formFiled(v,deleter))

    van.add(document.getElementById("formColumn"), compo)
    van.add(document.getElementById("jsonColumn"), result())
</script>

</body>

</html>
